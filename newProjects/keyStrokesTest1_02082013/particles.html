
$(document).ready(function() {


// particle array setup
var particles = [];
var particles2 = [];

// play switch setup
var playing = false;
var playing2 = false;

var bulletSpeed = 25;

function particle1EmmisionFunct() {
// if playing function is true
  if(playing) { 
// set Composite
    c.globalCompositeOperation = 'lighter';
//make 1 particle per frame
if (counter%5 == 0) {
    makeParticle(1);
  }
  }
} // close $particle1EmmisionFunct

function makeParticle(numParticles) {
  
  for(var i=0; i<numParticles; i++){
    var p = {
    x : gunPosX,
    y : gunPosY,
    xVel : bulletSpeed,
    yVel : 0,
    hue : random(360),
    size : random(15,18)
    }; // close var P
      
    // Per Particle adjustments

    if (faceLeft) {
      p.xVel = bulletSpeed*-1;
    } else if (faceRight) {
      p.xVel = bulletSpeed*1;
    }

    if (upKeyOn) {
      p.yVel = bulletSpeed*-1;
    }

    if (downKeyOn) {
      p.yVel = bulletSpeed*1;
    }
    // End Per Particle adjustments

    // create particles (p options)
    particles.push(p);
  } // close for loop

} // close function makeParticle

function particle1Updater() {
// Particle 1 For Loop
  for(var i=0; i<particles.length; i++) {
  var p = particles[i];

// Particle boundary check
  if (p.x < 0 || p.x > canvasW+p.size || p.y < 0 || p.y > canvasH+p.size)
  {
    particles.splice(i,1);
  } else {

    c.globalCompositeOperation = "lighter";
    c.fillStyle = rgb(255,40,40); 
    c.fillCircle(p.x,p.y,p.size);
     
    c.fillStyle = rgb(255,255,255);
    c.fillCircle(p.x,p.y,p.size*0.5);

var ctx = $('canvas').get(0).getContext('2d');

function circle(x, y, r, c) {
    ctx.beginPath();
    var rad = ctx.createRadialGradient(x, y, 1, x, y, r);
    rad.addColorStop(0, 'rgba('+c+',0.05)');
    rad.addColorStop(0.5, 'rgba('+c+',0.002)');
    rad.addColorStop(1, 'rgba('+c+',0)');
    ctx.fillStyle = rad;
    ctx.arc(x, y, r, 0, Math.PI*2, false);
    ctx.fill();
}

    // circle(p.x, p.y, p.size*25,'255,255,255');

    // c.fillStyle = rgba(255,200,200,0.1);
    // c.fillCircle(p.x,p.y,p.size*8);

    p.size*=0.98;

    p.x += p.xVel;
    p.y += p.yVel;

    // Particle/Enemy Collision
    var esY = floorLevel1-eS.height/2;

    if ( (p.x-p.size/2 >= eS.x) && (p.x+p.size/2 <= eS.x+eS.width) ) {
      if ( (p.y >= esY) && (p.y <= esY+eS.height) ) {
        eS.health -=10;
        eS.ColorR = 255;
        eS.ColorG = 255;
        eS.ColorB = 255;
        particles.splice(i,1);
      }
    }
 
  } 

}// close Particle 1 For Loop
}// close particle 1 updater

}); // close doc ready